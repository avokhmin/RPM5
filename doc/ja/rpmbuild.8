.\" This manpage has been automatically generated by docbook2man 
.\" from a DocBook document.  This tool can be found at:
.\" <http://shell.ipoline.com/~elmert/comp/docbook2X/> 
.\" Please send any bug reports, improvements, comments, patches, 
.\" etc. to Steve Cheng <steve@ggi-project.org>.
.\"
.\" This program is free software; you can redistribute it and/or modify
.\" it under the terms of the GNU General Public License as published by
.\" the Free Software Foundation; either version 2, or (at your option)
.\" any later version.
.\"
.\" This program is distributed in the hope that it will be useful,
.\" but WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\" GNU General Public License for more details.
.\"
.\" You should have received a copy of the GNU General Public License
.\" along with this program; if not, write to the Free Software
.\" Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, 
.\" USA.
.\"
.\" Japanese Version Copyright (C) 2003 System Design and Research
.\" Institute Co.,Ltd. All rights reserved.
.\"
.\" Translated 14 March 2003 by
.\"   System Design and Research Institute Co.,Ltd. <info@sdri.co.jp>
.\"
.TH "RPMBUILD" "8" "09 June 2002" "Red Hat, Inc." "Red Hat Linux"
.SH 名前
rpmbuils \- RPM パッケージのビルド
.SH 書式
.SS パッケージのビルド:
\fBrpmbuild\fR {\fB-ba|-bb|-bp|-bc|-bi|-bl|-bs\fR} [\fBrpmbuild-options\fR] \fB\fISPECFILE\fB\fR\fI ...\fR

\fBrpmbuild\fR {\fB-ta|-tb|-tp|-tc|-ti|-tl|-ts\fR} [\fBrpmbuild-options\fR] \fB\fITARBALL\fB\fR\fI ...\fR

\fBrpmbuild\fR {\fB--rebuild|--recompile\fR} \fB\fISOURCEPKG\fB\fR\fI ...\fR
.SS その他:
\fBrpmbuild\fR \fB--showrc\fR
.SS rpmbuild のオプション
  [\fB--buildroot \fIDIRECTORY\fB\fR] [\fB--clean\fR] [\fB--nobuild\fR]
  [\fB--rmsource\fR] [\fB--rmspec\fR] [\fB--short-circuit\fR] [\fB--sign\fR]
  [\fB--target \fIPLATFORM\fB\fR]
.SH 説明
.B rpmbuild
は、バイナリパッケージとソースパッケージの両方のビルド(作成)に利用される。
.B パッケージ
はファイルのアーカイブと、アーカイブされたファイルの
インストール・アンインストールに使われるメタデータから構成される。
メタデータは補助スクリプト、ファイル属性、
パッケージの説明に関する情報からなる。
.B パッケージ
には 2 種類あり、
インストールするためのソフトウェアをカプセル化するのに使われるバイナリ
パッケージと、バイナリパッケージを作成するのに必要なレシピとソースコード
からなるソースパッケージとがある。
.PP
次の基本モードからいずれか一つを選択しなければならない:
.BR パッケージのビルド 、 "tar アーカイブからのパッケージのビルド" 、
.BR パッケージの再コンパイル 、 設定の表示 。
.SS 一般的なオプション
以下のオプションはすべてのモードで使用可能である。
.TP
.BR \-? ", " \-\-help
使い方を通常よりも詳しく表示する。
.TP
\fB\-\-version\fR
使用中の
.B rpm
のバージョン番号を 1 行で表示する。
.TP
\fB\-\-quiet\fR
表示をできるだけ少なくする。
通常は、エラーメッセージだけが表示される。
.TP
\fB\-v\fR
より多くの情報を表示する。
通常は、ルーチンの進捗メッセージが表示される。
.TP
\fB\-vv\fR
沢山の汚いデバッグ情報を表示する。
.TP
.BI \-\-rcfile " FILELIST"
.B rpm
は、コロン(`:')で区切られた
.I FILELIST
の各ファイルを設定情報として読み込む。
読み込みは
.I FILELIST
に指定された順番で行われる。
.I FILELIST
のデフォルトは
.IR /usr/lib/rpm/rpmrc : /usr/lib/rpm/redhat/rpmrc : ~/.rpmrc
である。
.TP
.BI \-\-pipe  " CMD"
.B rpm
コマンドの出力を
.I CMD
へパイプする。
.TP
.BI \-\-dbpath " DIRECTORY"
データベースのパスとして、デフォルトの
.I /var/lib/rpm
ではなく
.I DIRECTORY
を使う。
.TP
.BI \-\-root " DIRECTORY"
.\" motoki: after 以下が will be used for 〜 にかかるのかが不明。
.\" motoki: will be run にだけかかるのだと思いますが・・・
すべての操作において、
.I DIRECTORY
をルートとしたファイルシステムを使う。
つまり、
.I DIRECTORY
内にあるデータベースが依存性のチェックに使用され、
.I DIRECTORY
に chroot(2) した後で、すべてのスクリプト
(例えば、パッケージインストール時の
.B %post
や、パッケージビルド時の
.B %prep
など) が実行される。
.SS ビルドオプション
rpm のビルド・コマンドの一般的な形式は以下の通りである:
.RS 0.2i
.PP
.B rpmbuild
.BI \-b STAGE |\-t STAGE
.RB "[ " rpmbuild\-options " ]"
.I "FILE ..."
.RE
.PP
パッケージのビルドに spec ファイルを使用するのであれば
.B \-b
を、
.B rpmbuild
が spec ファイルを使うために (圧縮されていることもある) tar ファイルの
内部から使用する spec ファイルを探すのであれば
.B \-t
を、それぞれ引数に指定する。
最初の引数の後ろにある、次の文字
.RI ( STAGE )
はビルドとパッケージ化の段階を指定するのに使われ、
以下のいずれかが指定される
(訳注: 以下のものは spec ファイル、すなわち \-b が指定された場合であり、
tar ファイルからビルドする場合は \-ta, \-tb, ... となる)。
.TP
\fB\-ba\fR
(%prep, %build, %install を実行した後に)
バイナリパッケージとソースパッケージをビルドする。
.TP
\fB\-bb\fR
(%prep, %build, %install を実行した後に)
バイナリパッケージをビルドする。
.TP
\fB\-bp\fR
spec ファイルから "%prep" 段階を実行する。
通常、ソースを展開しパッチを適用することを意味する。
.TP
\fB\-bc\fR
(%prep を実行した後に)
spec ファイルから "%build" 段階を実行する。
一般的には "make" と等価である。
.TP
\fB\-bi\fR
(%prep, %build を実行した後に)
spec ファイルから "%install" 段階を実行する。
一般的には "make install" と等価である。
.TP
\fB\-bl\fR
"list check" を実行する。
spec ファイルの "%files" セクションのマクロが展開され、
各ファイルが存在するかの検証をするためのチェックが行われる。
.TP
\fB\-bs\fR
ソースパッケージだけをビルドする。
.PP
さらに、以下のオプションが利用可能である:
.TP
.BI \-\-buildroot " DIRECTORY"
パッケージビルド時に BuildRoot タグを
.I DIRECTORY
ディレクトリに上書きする。
.TP
\fB\-\-clean\fR
パッケージが作成された後にビルドツリーを削除する。
.TP
\fB\-\-nobuild\fR
何のビルドも実行しない。spec ファイルの検査を行う場合に便利である。
.TP
\fB\-\-rmsource\fR
ビルド後にソースを削除する
(単独で使用してもよい。例: "\fBrpmbuild \-\-rmsource foo.spec\fR")。
.TP
\fB\-\-rmspec\fR
ビルド後に spec ファイルを削除する。
(単独で使用してもよい。例: "\fBrpmbuild \-\-rmspec foo.spec\fR")。
.TP
\fB\-\-short\-circuit\fR
指定された段階へ直接すすむ(すなわち、指定された段階までの全ての段階が
飛ばされる)。
.B \-bc
と
.B \-bi
(訳注:
.B \-tc
と
.BR \-ti も)
でのみ使用できる。
.TP
\fB\-\-sign\fR
パッケージに GPG 署名を埋め込む。
この署名は、パッケージの出所と完全性を検証するのに用いることができる。
設定の詳細については
.BR rpm (8)
の「GPG 署名」の節を参照のこと。
.TP
.BI \-\-target " PLATFORM"
パッケージビルド時に
.I PLATFORM
を
.B arch-vendor-os
と解釈し、それに応じてマクロ
.BR %_target ,
.BR %_target_arch ,
.B %_target_os
を設定する。
.SS ビルドと再コンパイルのオプション
rpm を使ってビルドするには、他にも 2 つのやり方がある。
.RS 0.2i
.PP
.BI "rpmbuild \-\-rebuild|\-\-recompile" " SOURCEPKG ..."
.RE
.PP 
この方法で起動された場合、
.B rpmbuild
は指定されたソースパッケージをインストールし、
準備、コンパイル、インストールを行う。
さらに、
.B \-\-rebuild
の場合、新たなバイナリパッケージをビルドする。ビルドか完了したら
ビルドディレクトリは
.RB ( \-\-clean
を指定した場合と同様に)削除され、
パッケージのソースと spec ファイルも削除される。
.SS "SHOWRC"
コマンド
.RS .02i
.PP
.B "rpmbuild \-\-showrc"
.RE
.PP
は
.B rpmbuild
が使う設定ファイル、
.I rpmrc
と
.I macros
で現在セットされているオプションすべての値を表示する。
.SH ファイル
.SS "rpmrc の設定"
.nf
\fI/usr/lib/rpm/rpmrc\fR
\fI/usr/lib/rpm/redhat/rpmrc\fR
\fI/etc/rpmrc\fR
\fI~/.rpmrc\fR
.fi
.SS マクロの設定
.nf
\fI/usr/lib/rpm/macros\fR
\fI/usr/lib/rpm/redhat/macros\fR
\fI/etc/rpm/macros\fR
\fI~/.rpmmacros\fR
.fi
.SS データベース
.nf
\fI/var/lib/rpm/Basenames\fR
\fI/var/lib/rpm/Conflictname\fR
\fI/var/lib/rpm/Dirnames\fR
\fI/var/lib/rpm/Filemd5s\fR
\fI/var/lib/rpm/Group\fR
\fI/var/lib/rpm/Installtid\fR
\fI/var/lib/rpm/Name\fR
\fI/var/lib/rpm/Packages\fR
\fI/var/lib/rpm/Providename\fR
\fI/var/lib/rpm/Provideversion\fR
\fI/var/lib/rpm/Pubkeys\fR
\fI/var/lib/rpm/Removed\fR
\fI/var/lib/rpm/Requirename\fR
\fI/var/lib/rpm/Requireversion\fR
\fI/var/lib/rpm/Sha1header\fR
\fI/var/lib/rpm/Sigmd5\fR
\fI/var/lib/rpm/Triggername\fR
.fi
.SS 一時ファイル
\fI/var/tmp/rpm*\fR
.SH 関連項目
.BR popt (3),
.BR rpm2cpio (8),
.BR gendiff (1),
.BR rpm (8),
.nf

.UR http://www.rpm.org/
.B http://www.rpm.org/
.UE
.fi
.SH 著者
.nf
Marc Ewing <marc@redhat.com>
Jeff Johnson <jbj@redhat.com>
Erik Troan <ewt@redhat.com>
.fi
