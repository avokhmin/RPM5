LIBOBJECTS = header.o oldrpmdb.o misc.o messages.o rpmerr.o falloc.o \
	     convertdb.o oldrpmfile.o var.o md5.o md5sum.o dbindex.o \
	     rpmdb.o stringbuf.o rpmlead.o package.o uninstall.o
LIBRPM = librpm.a
LOADLIBES = -lrpm -lgdbm -ldb $(LIBEFENCE)
PROGS = test dump dumpdb

# -----------------------------------------------------------------------

ifeq (.depend,$(wildcard .depend))
TARGET=allprogs
else
TARGET=depend allprogs
endif

all: $(TARGET)

allprogs: $(LIBRPM) $(PROGS)

$(LIBRPM): $(LIBOBJECTS) 
	$(AR) $@ $(LIBOBJECTS)
	$(RANLIB) $@

clean:
	rm -f *.a *.o *~ $(PROGS) test.out

squeaky: clean
	rm -f depend

depend:
	$(CPP) $(CFLAGS) -M *.c > .depend

ifeq (.depend,$(wildcard .depend))
include .depend
endif
